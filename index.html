<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Black Russia - Locus Gold</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adsgram.ai/sdk-v1.js"></script>
    
    <style>
        :root { --br-red: #ff3333; --bg: #0a0a0c; }
        body { background: var(--bg); color: #fff; font-family: 'Montserrat', sans-serif; overflow: hidden; height: 100vh; user-select: none; }
        .oswald { font-family: 'Oswald', sans-serif; text-transform: uppercase; font-style: italic; }
        .main-btn {
            width: 220px; height: 220px; border-radius: 50%;
            background: radial-gradient(circle, #252529 0%, #000 100%);
            border: 6px solid #1f1f22; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
            transition: transform 0.05s ease-out; margin: 40px auto;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }
        .main-btn:active { transform: scale(0.95); }
        .main-btn::before { content: "BR"; font-family: 'Oswald'; font-size: 80px; color: var(--br-red); font-weight: 900; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 999; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .track { display: flex; position: absolute; height: 100%; transition: transform 9s cubic-bezier(0.1, 0, 0.05, 1); }
        .item { min-width: 150px; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #141416; border-right: 1px solid #111; }
        .btn-red { background: linear-gradient(90deg, #ff3333, #b30000); font-weight: 900; text-transform: uppercase; }
        .nav-active { color: var(--br-red) !important; }
        .nav-active .dot { background: var(--br-red); box-shadow: 0 0 8px var(--br-red); }
        button:disabled { opacity: 0.5; filter: grayscale(1); }
    </style>
</head>
<body>

<div class="max-w-md mx-auto h-screen flex flex-col relative">
    <header class="p-6 flex justify-between items-start">
        <div><p class="text-[10px] text-gray-500 font-bold uppercase">–ò–≥—Ä–æ–≤–æ–π –±–∞–ª–∞–Ω—Å</p><p id="bal-rub" class="text-2xl font-black oswald">0 ‚ÇΩ</p></div>
        <div class="text-right"><p class="text-[10px] text-blue-500 font-bold uppercase">–î–æ–Ω–∞—Ç —Å—á—ë—Ç</p><p id="bal-bc" class="text-2xl font-black text-blue-400 oswald">0 BC</p></div>
    </header>

    <main class="flex-1 overflow-y-auto px-6 pb-28">
        <section id="tab-home" class="tab-view">
            <div class="main-btn" onclick="Game.click()">
                <p class="oswald text-[10px] mt-2 tracking-widest text-gray-500">–ù–∞–∂–∏–º–∞–π —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å</p>
            </div>
        </section>

        <section id="tab-cases" class="tab-view hidden space-y-4">
            <h2 class="oswald text-xl italic mb-4">–ú–∞–≥–∞–∑–∏–Ω –∫–µ–π—Å–æ–≤</h2>
            <div class="bg-white/5 p-4 rounded-2xl flex justify-between items-center border-l-4 border-blue-500">
                <div class="flex gap-3 items-center"><span>üíé</span><div><p class="font-bold text-xs uppercase">–ú–ê–ñ–û–†</p><p id="ad-stat" class="text-[9px] text-blue-400 font-bold">ADS: 0 / 5</p></div></div>
                <button id="ad-btn" onclick="Game.watchAd()" class="bg-blue-600 px-6 py-2 rounded-xl text-[10px] font-black">–°–ú–û–¢–†–ï–¢–¨</button>
            </div>
        </section>
        
        <section id="tab-garage" class="tab-view hidden"><div id="garage-list" class="grid grid-cols-2 gap-4"></div></section>
    </main>

    <div id="modal" class="modal-overlay">
        <div class="relative w-full h-[140px] my-10 overflow-hidden border-y border-white/10">
            <div class="absolute left-1/2 top-0 bottom-0 w-1 bg-red-600 z-10 -translate-x-1/2"></div>
            <div id="track" class="track"></div>
        </div>
        <div id="win-ui" class="hidden flex flex-col items-center">
            <h3 id="win-name" class="oswald text-2xl mb-8 text-center px-6">---</h3>
            <button onclick="Game.claim()" class="btn-red px-16 py-4 rounded-full text-[10px]">–ó–ê–ë–†–ê–¢–¨</button>
        </div>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-black/90 border-t border-white/5 flex justify-around py-4 z-50">
        <div onclick="Game.tab('home')" id="n-home" class="flex flex-col items-center gap-1 cursor-pointer nav-active"><span class="text-xl">üè†</span><span class="text-[8px] font-bold">–ì–õ–ê–í–ù–ê–Ø</span><div class="dot w-1 h-1 rounded-full"></div></div>
        <div onclick="Game.tab('cases')" id="n-cases" class="flex flex-col items-center gap-1 cursor-pointer"><span class="text-xl">üì¶</span><span class="text-[8px] font-bold">–ö–ï–ô–°–´</span><div class="dot w-1 h-1 rounded-full"></div></div>
    </nav>
</div>

<script>
const Game = {
    u: { m:0, bc:0, ads:0, inv:[] },
    adController: null,

    init() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        const s = localStorage.getItem('locus_save_v11');
        if(s) this.u = JSON.parse(s);

        // –ü–†–ï–î–í–ê–†–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –†–ï–ö–õ–ê–ú–´ (—Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
        if (window.Adsgram) {
            this.adController = window.Adsgram.init({ blockId: "20963" });
        }

        this.updateUI();
    },

    async watchAd() {
        const btn = document.getElementById('ad-btn');
        
        if (!this.adController) {
            alert("–û—à–∏–±–∫–∞: SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤ Telegram.");
            return;
        }

        btn.disabled = true;
        btn.innerText = "–ó–ê–ì–†–£–ó–ö–ê...";

        try {
            // –í—ã–∑–æ–≤ —Ä–µ–∫–ª–∞–º—ã (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Promise)
            const result = await this.adController.show();
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å–º–æ—Ç—Ä–µ–ª —Ä–µ–∫–ª–∞–º—É –¥–æ –∫–æ–Ω—Ü–∞
            if (result.done) {
                this.u.ads++;
                if (this.u.ads >= 5) {
                    this.u.ads = 0;
                    alert("–í—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –∫–µ–π—Å—É!");
                    // –¢—É—Ç –ª–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞
                }
                this.updateUI();
                this.save();
            }
        } catch (error) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Adsgram
            if (error.error === 'no_ads') {
                alert("–°–µ–π—á–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
            } else if (error.error === 'user_closed') {
                alert("–†–µ–∫–ª–∞–º–∞ –∑–∞–∫—Ä—ã—Ç–∞ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ. –ù–∞–≥—Ä–∞–¥–∞ –Ω–µ –ø–æ–ª—É—á–µ–Ω–∞.");
            } else {
                console.error("Adsgram error:", error);
                alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∫–ª–∞–º—ã.");
            }
        } finally {
            btn.disabled = false;
            btn.innerText = "–°–ú–û–¢–†–ï–¢–¨";
        }
    },

    save() { localStorage.setItem('locus_save_v11', JSON.stringify(this.u)); },
    updateUI() {
        document.getElementById('bal-rub').innerText = this.u.m.toLocaleString() + ' ‚ÇΩ';
        document.getElementById('ad-stat').innerText = `ADS: ${this.u.ads} / 5`;
    },
    click() { this.u.m += 500; this.updateUI(); this.save(); },
    tab(id) {
        document.querySelectorAll('.tab-view').forEach(t => t.classList.add('hidden'));
        document.querySelectorAll('nav div').forEach(n => n.classList.remove('nav-active'));
        document.getElementById('tab-'+id).classList.remove('hidden');
        document.getElementById('n-'+id).classList.add('nav-active');
    }
};

window.onload = () => Game.init();
</script>
</body>
</html>
