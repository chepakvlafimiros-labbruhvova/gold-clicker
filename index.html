<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Locus Gold</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://sad.adsgram.ai/js/adsgram-ad-sdk.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
        body {
            margin: 0; padding: 0; background-color: #000; color: #fff;
            font-family: 'Roboto', sans-serif; display: flex; flex-direction: column; height: 100vh;
            /* –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–∏–Ω–µ–≤—É */
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }
        .page { display: none; flex-direction: column; align-items: center; width: 100%; flex-grow: 1; padding-bottom: 80px; }
        .page.active { display: flex; }

        .score-container {
            margin: 20px 0; width: 90%; background: #1a1a1a;
            border: 1px solid #333; border-radius: 20px; padding: 25px 0;
            text-align: center;
        }
        #gold-display { font-size: 64px; font-weight: 900; color: #ffca28; margin: 0; }

        .coin-section { flex-grow: 1; display: flex; align-items: center; justify-content: center; }
        
        /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –±–µ–∑ —Å–∏–Ω–µ–≤—ã */
        #click-btn {
            width: 240px; height: 240px; background: #ffca28; border-radius: 50%;
            border: 8px solid #b8860b; font-size: 100px; font-weight: bold; color: #000;
            cursor: pointer; outline: none;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 0 50px rgba(255, 202, 40, 0.4); 
            transition: transform 0.05s;
            display: flex; align-items: center; justify-content: center;
        }
        #click-btn:active { transform: scale(0.92); }

        .actions { width: 90%; display: flex; flex-direction: column; gap: 12px; margin: 20px 0; }
        .btn { padding: 18px; border-radius: 15px; border: none; font-weight: bold; font-size: 16px; color: #fff; }
        .btn-ad { background: #2ecc71; }
        .btn-upgrade { background: #3498db; }

        .tab-bar { position: fixed; bottom: 0; width: 100%; display: flex; background: #111; border-top: 1px solid #222; }
        .tab { flex: 1; padding: 20px 0; text-align: center; font-size: 12px; color: #555; }
        .tab.active { color: #ffca28; border-top: 2px solid #ffca28; }
    </style>
</head>
<body>

    <div class="score-container">
        <div id="gold-display">0</div>
    </div>

    <div id="page-main" class="page active">
        <div class="coin-section">
            <button id="click-btn">G</button>
        </div>
        <div class="actions">
            <button class="btn btn-ad" onclick="showRewardedAd()">üì∫ +10 G (–†–ï–ö–õ–ê–ú–ê)</button>
        </div>
    </div>

    <div class="tab-bar">
        <div class="tab active">–ì–õ–ê–í–ù–ê–Ø</div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCoa29KS-sin6hoRz0ZbE4f3ki0tZLwkKI",
            authDomain: "gold-clicker-5d882.firebaseapp.com",
            projectId: "gold-clicker-5d882",
            storageBucket: "gold-clicker-5d882.firebasestorage.app",
            messagingSenderId: "83489312782",
            appId: "1:83489312782:web:ee5b7bdc390e53e7dd6c5f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const tg = window.Telegram.WebApp;
        tg.expand();

        const AdController = window.Adsgram ? window.Adsgram.init({ blockId: "19883" }) : null;
        const userId = tg.initDataUnsafe?.user?.id ? tg.initDataUnsafe.user.id.toString() : "5223115893";
        const playerRef = db.collection('players').doc(userId);

        let gold = 0;

        async function init() {
            const doc = await playerRef.get();
            if (doc.exists) {
                gold = Number(doc.data().gold) || 0;
            } else {
                await playerRef.set({ gold: 0 });
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('gold-display').innerText = Math.floor(gold);
        }

        // –ö–ª–∏–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
        document.getElementById('click-btn').addEventListener('click', (e) => {
            e.preventDefault(); // –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∂–µ—Å—Ç–æ–≤
            gold++;
            updateUI();
            playerRef.update({ gold: gold }).catch(err => console.error("–û—à–∏–±–∫–∞ –±–∞–∑—ã:", err));
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        });

        async function showRewardedAd() {
            if (!AdController) return tg.showAlert("–†–µ–∫–ª–∞–º–Ω—ã–π –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω");
            
            AdController.show().then(() => {
                gold += 10;
                updateUI();
                playerRef.update({ gold: gold });
                tg.showAlert("–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å!");
            }).catch((err) => {
                console.log("Ad error:", err);
                tg.showAlert("–†–µ–∫–ª–∞–º–∞ –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
            });
        }

        init();
    </script>
</body>
</html>
