<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gold Locus</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
        body {
            margin: 0; padding: 0;
            background-color: #000; /* –ì–ª—É–±–æ–∫–∏–π —á–µ—Ä–Ω—ã–π —Ñ–æ–Ω –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω–µ */
            color: #fff;
            font-family: 'Roboto', sans-serif;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
            user-select: none; -webkit-tap-highlight-color: transparent;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å–æ —Å—á–µ—Ç–æ–º */
        .score-container {
            margin-top: 30px;
            width: 90%;
            background: linear-gradient(180deg, #1c1c1c 0%, #0f0f0f 100%);
            border: 1px solid #333;
            border-radius: 20px;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        #gold-display {
            font-size: 58px;
            font-weight: 900;
            color: #ffca28; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ */
            margin: 0;
        }

        /* –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞-–º–æ–Ω–µ—Ç–∞ */
        .game-area {
            flex-grow: 1;
            display: flex; align-items: center; justify-content: center;
        }

        #click-btn {
            width: 250px; height: 250px;
            background: #ffca28;
            border-radius: 50%;
            border: 8px solid #b8860b;
            font-size: 100px; font-weight: bold;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 50px rgba(255, 202, 40, 0.2);
            transition: transform 0.05s;
            color: #000;
        }

        #click-btn:active { transform: scale(0.95); }

        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –∫–∞–∫ –Ω–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–µ */
        .actions {
            width: 90%;
            display: flex; flex-direction: column; gap: 10px;
            margin-bottom: 20px;
        }

        .btn-action {
            width: 100%;
            padding: 15px;
            border-radius: 15px;
            border: none;
            font-weight: bold;
            font-size: 16px;
            display: flex; align-items: center; justify-content: center;
            gap: 10px;
            cursor: pointer;
        }

        .btn-bonus { background-color: #2ecc71; color: white; } /* –ó–µ–ª–µ–Ω–∞—è */
        .btn-upgrade { background-color: #3498db; color: white; } /* –°–∏–Ω—è—è */

        .info-text { font-size: 12px; color: #666; margin-bottom: 20px; }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .tab-bar {
            width: 100%;
            display: flex;
            background-color: #111;
            border-top: 1px solid #222;
        }

        .tab-item {
            flex: 1;
            padding: 15px 0;
            text-align: center;
            font-size: 12px;
            color: #555;
            text-transform: uppercase;
            font-weight: bold;
        }

        .tab-item.active { color: #ffca28; border-top: 2px solid #ffca28; }
    </style>
</head>
<body>

    <div class="score-container">
        <div id="gold-display">0</div>
    </div>

    <div class="game-area">
        <button id="click-btn">G</button>
    </div>

    <div class="actions">
        <button class="btn-action btn-bonus" onclick="alert('–ë–æ–Ω—É—Å +5.000 G –∑–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä!')">
            üì∫ +5.000 G (–ë–û–ù–£–°)
        </button>
        <button class="btn-action btn-upgrade" onclick="alert('–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ!')">
            üöÄ +0.001 –ö –ö–õ–ò–ö–£
        </button>
    </div>

    <div class="info-text">–°–∏–ª–∞ –∫–ª–∏–∫–∞: 0.005 G</div>

    <div class="tab-bar">
        <div class="tab-item active">–ì–õ–ê–í–ù–ê–Ø</div>
        <div class="tab-item">–ë–û–ù–£–°</div>
        <div class="tab-item">–í–´–í–û–î</div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCoa29KS-sin6hoRz0ZbE4f3ki0tZLwkKI",
            authDomain: "gold-clicker-5d882.firebaseapp.com",
            projectId: "gold-clicker-5d882",
            storageBucket: "gold-clicker-5d882.firebasestorage.app",
            messagingSenderId: "83489312782",
            appId: "1:83489312782:web:ee5b7bdc390e53e7dd6c5f"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const tg = window.Telegram.WebApp;
        tg.expand();

        const userId = tg.initDataUnsafe?.user?.id ? tg.initDataUnsafe.user.id.toString() : "5223115893";
        const playerRef = db.collection('players').doc(userId);

        let gold = 0;
        const display = document.getElementById('gold-display');

        async function loadData() {
            try {
                const doc = await playerRef.get();
                if (doc.exists) {
                    // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º NaN: –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ —á–∏—Å–ª–æ
                    const savedGold = doc.data().gold;
                    gold = isNaN(savedGold) ? 0 : savedGold;
                }
                display.innerText = gold;
            } catch (e) { console.log(e); }
        }

        document.getElementById('click-btn').addEventListener('click', () => {
            gold++;
            display.innerText = gold;
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
            playerRef.set({ gold: gold }, { merge: true });
        });

        loadData();
    </script>
</body>
</html>
