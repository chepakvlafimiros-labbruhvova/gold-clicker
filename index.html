<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Locus Gold</title>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-database-compat.js"></script>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { background: #0a0a0a; color: #fff; font-family: 'Montserrat', sans-serif; overflow: hidden; height: 100vh; user-select: none; }
        .tab-content { display: none; height: calc(100vh - 160px); overflow-y: auto; padding-bottom: 20px; }
        .active { display: block; }
        .card { background: #151515; border-radius: 20px; padding: 16px; border: 1px solid #222; }
        .btn-red { background: linear-gradient(180deg, #ff3b3b 0%, #b30000 100%); border-radius: 12px; font-weight: 900; transition: transform 0.1s; }
        .btn-red:active { transform: scale(0.95); }
        .btn-blue { background: #2563eb; border-radius: 12px; font-weight: 900; }
        .nav-active { color: #ff3b3b !important; }
        input, select { background: #1a1a1a; border: 1px solid #333; color: white; padding: 12px; border-radius: 12px; width: 100%; outline: none; font-size: 14px; }
        /* –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞ */
        .click-circle { width: 180px; height: 180px; border-radius: 50%; background: radial-gradient(circle, #1a1a1a 0%, #000 100%); border: 4px solid #222; display: flex; align-items: center; justify-content: center; margin: 40px auto; cursor: pointer; box-shadow: 0 0 30px rgba(255,0,0,0.1); }
        .click-circle:active { transform: scale(0.92); }
    </style>
</head>
<body>

<div class="p-5 h-full flex flex-col">
    <div class="flex justify-between items-start mb-4">
        <div>
            <p class="text-[10px] text-gray-500 font-bold italic uppercase">–ò–≥—Ä–æ–≤–æ–π –±–∞–ª–∞–Ω—Å</p>
            <p id="m-rub" class="text-2xl font-black italic">0 ‚ÇΩ</p>
        </div>
        <div class="text-right">
            <p class="text-[10px] text-blue-500 font-bold italic uppercase">–î–æ–Ω–∞—Ç —Å—á—ë—Ç</p>
            <p id="m-bc" class="text-2xl font-black italic text-blue-400">0 BC</p>
        </div>
    </div>

    <div id="tab-home" class="tab-content active text-center">
        <div class="click-circle" onclick="Game.click()">
            <span class="text-6xl font-black text-red-600 italic">BR</span>
        </div>
        <div class="card mt-10 text-left">
            <div class="flex justify-between items-center mb-3">
                <span class="text-blue-500 text-[10px] font-bold italic uppercase">–û–±–º–µ–Ω –≤–∞–ª—é—Ç—ã</span>
                <span class="text-gray-500 text-[10px]">1.000.000 ‚ÇΩ = 1 BC</span>
            </div>
            <div class="flex gap-2">
                <input id="ex-val" type="number" placeholder="–°—É–º–º–∞ ‚ÇΩ">
                <button onclick="Game.exchange()" class="btn-blue px-6 py-2 text-[10px] uppercase">–û–±–º–µ–Ω</button>
            </div>
        </div>
    </div>

    <div id="tab-cases" class="tab-content space-y-3">
        <h2 class="text-center font-black italic text-xl py-2 uppercase">–ú–∞–≥–∞–∑–∏–Ω –∫–µ–π—Å–æ–≤</h2>
        
        <div class="card flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="text-2xl">‚è≥</span>
                <div><p class="text-sm font-black uppercase">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π</p><p id="timer" class="text-[10px] text-green-500 font-bold">–ì–æ—Ç–æ–≤–æ</p></div>
            </div>
            <button id="daily-btn" onclick="Game.openDaily()" class="btn-red px-6 py-2 text-[10px] uppercase text-white">–û—Ç–∫—Ä—ã—Ç—å</button>
        </div>

        <div class="card flex justify-between items-center border-l-4 border-green-500">
            <div class="flex items-center gap-3">
                <span class="text-2xl">üéÅ</span>
                <div><p class="text-sm font-black uppercase text-green-500">–•–∞–ª—è–≤–∞ (1 ADS)</p><p class="text-[10px] text-gray-400">–ü—Ä–∏–∑: 25-100 BC</p></div>
            </div>
            <button onclick="Game.watchAd('lite')" class="bg-green-600 rounded-xl px-6 py-2 text-[10px] uppercase font-black">–û—Ç–∫—Ä—ã—Ç—å</button>
        </div>

        <div class="card flex justify-between items-center border-l-4 border-blue-500">
            <div class="flex items-center gap-3">
                <span class="text-2xl">üíé</span>
                <div><p class="text-sm font-black uppercase text-blue-400">–ú–∞–∂–æ—Ä (5 ADS)</p><p id="ad-prog" class="text-[10px] text-gray-400">–ü—Ä–æ–≥—Ä–µ—Å—Å: 0/5</p></div>
            </div>
            <button onclick="Game.watchAd('major')" class="btn-blue px-6 py-2 text-[10px] uppercase">–°–º–æ—Ç—Ä–µ—Ç—å</button>
        </div>

        <div class="card space-y-3">
            <p class="text-[10px] font-black text-red-500 uppercase italic">–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞ (+50 BC)</p>
            <div class="flex gap-2">
                <input id="ref-link" readonly class="text-[10px] text-gray-500" value="–ó–∞–≥—Ä—É–∑–∫–∞...">
                <button onclick="Game.copyRef()" class="btn-red px-4 py-2 text-[9px] uppercase">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div id="ref-list" class="space-y-1 pt-2"></div>
        </div>
    </div>

    <div id="tab-garage" class="tab-content text-center">
        <h2 class="font-black italic text-xl py-4 uppercase">–ì–∞—Ä–∞–∂</h2>
        <p class="text-gray-600 mt-20 italic">–ì–∞—Ä–∞–∂ –ø–æ–∫–∞ –ø—É—Å—Ç</p>
    </div>

    <div id="tab-out" class="tab-content">
        <div class="card space-y-4">
            <h2 class="text-center font-black italic text-red-500 uppercase">–í—ã–≤–æ–¥ Black Coins</h2>
            <input id="out-nick" type="text" placeholder="–í–∞—à Nick_Name">
            <select id="out-srv"></select>
            <input id="out-sum" type="number" placeholder="–°—É–º–º–∞ BC">
            <button onclick="Game.withdraw()" class="btn-red w-full py-4 uppercase text-sm">–ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
        </div>
        <div class="mt-6">
            <p class="text-gray-500 text-[10px] font-bold uppercase italic mb-2">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–≤–æ–¥–æ–≤</p>
            <div id="out-history" class="space-y-2"></div>
        </div>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-[#0d0d0d] border-t border-[#222] flex justify-around py-4">
        <div onclick="Game.tab('home')" id="n-home" class="flex flex-col items-center gap-1 text-gray-500 nav-active cursor-pointer">
            <span class="text-xl">üè†</span><span class="text-[9px] font-black uppercase">–ò–≥—Ä–∞</span>
        </div>
        <div onclick="Game.tab('cases')" id="n-cases" class="flex flex-col items-center gap-1 text-gray-500 cursor-pointer">
            <span class="text-xl">üì¶</span><span class="text-[9px] font-black uppercase">–ö–µ–π—Å—ã</span>
        </div>
        <div onclick="Game.tab('garage')" id="n-garage" class="flex flex-col items-center gap-1 text-gray-500 cursor-pointer">
            <span class="text-xl">üèéÔ∏è</span><span class="text-[9px] font-black uppercase">–ì–∞—Ä–∞–∂</span>
        </div>
        <div onclick="Game.tab('out')" id="n-out" class="flex flex-col items-center gap-1 text-gray-500 cursor-pointer">
            <span class="text-xl">üí≥</span><span class="text-[9px] font-black uppercase">–í—ã–≤–æ–¥</span>
        </div>
    </nav>
</div>

<script>
// –¢–í–û–ô FIREBASE CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyA4zMBfNc1wTIN75Qr1KMBTrlgiU5qG-fA",
  authDomain: "locus-gold-game.firebaseapp.com",
  projectId: "locus-gold-game",
  storageBucket: "locus-gold-game.firebasestorage.app",
  messagingSenderId: "450338666762",
  appId: "1:450338666762:web:f40ef7268c539ef16662f3"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// –ü–æ–ª—É—á–∞–µ–º ID –∏–∑ Telegram –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π
const userId = new URLSearchParams(window.location.search).get('id') || "user_test_1";

const SERVERS = ["RED [1]", "GREEN [2]", "BLUE [3]", "YELLOW [4]", "ORANGE [5]", "BLACK [10]", "MOSCOW [23]"];

const Game = {
    u: { m: 0, bc: 0, adM: 0, lastDaily: 0, invitedBy: null },
    
    init() {
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        db.ref('users/' + userId).on('value', (s) => {
            if(s.exists()) this.u = { ...this.u, ...s.val() };
            this.updateUI();
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤
        const sel = document.getElementById('out-srv');
        SERVERS.forEach(x => { sel.innerHTML += `<option value="${x}">${x}</option>`; });

        // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
        document.getElementById('ref-link').value = `https://t.me/–¢–í–û–ô_–ë–û–¢?start=${userId}`;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
        const refId = new URLSearchParams(window.location.search).get('start');
        if(refId && refId !== userId) this.checkReferral(refId);

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Å–ø–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π
        this.loadHistory();
        this.loadRefs();
        setInterval(() => this.tickDaily(), 1000);
    },

    save() { db.ref('users/' + userId).set(this.u); },

    updateUI() {
        document.getElementById('m-rub').innerText = Math.floor(this.u.m).toLocaleString() + ' ‚ÇΩ';
        document.getElementById('m-bc').innerText = this.u.bc.toLocaleString() + ' BC';
        document.getElementById('ad-prog').innerText = `–ü—Ä–æ–≥—Ä–µ—Å—Å: ${this.u.adM || 0}/5`;
    },

    click() { this.u.m += 250; this.save(); },

    tab(id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('nav div').forEach(n => n.classList.remove('nav-active'));
        document.getElementById('tab-'+id).classList.add('active');
        document.getElementById('n-'+id).classList.add('nav-active');
    },

    async watchAd(type) {
        try {
            const ad = window.Adsgram.init({ blockId: "20963" });
            const res = await ad.show();
            if(res.done) {
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —Ä–µ–∫–ª–∞–º—É
                if(type === 'lite') {
                    const win = Math.floor(Math.random() * 75) + 25;
                    this.u.bc += win; alert(`–í—ã–ø–∞–ª–æ: ${win} BC!`);
                } else {
                    this.u.adM = (this.u.adM || 0) + 1;
                    if(this.u.adM >= 5) {
                        this.u.adM = 0; const win = Math.floor(Math.random() * 150) + 50;
                        this.u.bc += win; alert(`–ö–µ–π—Å –ú–ê–ñ–û–†: +${win} BC!`);
                    }
                }
                
                // –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ
                if(this.u.invitedBy) this.updateRefProgress();

                this.save();
            }
        } catch(e) { alert("–†–µ–∫–ª–∞–º–∞ –Ω–µ –≥–æ—Ç–æ–≤–∞"); }
    },

    checkReferral(refId) {
        db.ref('users/' + userId).once('value', (s) => {
            if(!s.exists()) {
                this.u.invitedBy = refId;
                db.ref('referrals/' + refId + '/' + userId).set({ ads: 0, done: false });
                this.save();
            }
        });
    },

    updateRefProgress() {
        const refPath = `referrals/${this.u.invitedBy}/${userId}`;
        db.ref(refPath).once('value', (s) => {
            if(s.exists()) {
                let data = s.val();
                if(!data.done) {
                    data.ads++;
                    if(data.ads >= 3) {
                        data.done = true;
                        db.ref(`users/${this.u.invitedBy}/bc`).transaction(bc => (bc || 0) + 50);
                    }
                    db.ref(refPath).set(data);
                }
            }
        });
    },

    loadRefs() {
        db.ref('referrals/' + userId).on('value', (s) => {
            const div = document.getElementById('ref-list');
            div.innerHTML = '';
            s.forEach(child => {
                const d = child.val();
                div.innerHTML += `<div class="flex justify-between text-[9px] bg-black/20 p-2 rounded">
                    <span class="text-gray-400 italic">ID: ...${child.key.slice(-4)}</span>
                    <span class="${d.done ? 'text-green-500' : 'text-yellow-500'} font-bold">
                        ${d.done ? '‚úÖ +50 BC' : '‚è≥ –†–µ–∫–ª–∞–º–∞: ' + d.ads + '/3'}
                    </span>
                </div>`;
            });
        });
    },

    exchange() {
        const v = parseInt(document.getElementById('ex-val').value);
        if(v >= 1000000 && this.u.m >= v) {
            this.u.m -= v; this.u.bc += Math.floor(v/1000000); this.save();
            alert("–£—Å–ø–µ—à–Ω–æ!");
        } else alert("–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 1.000.000 ‚ÇΩ");
    },

    withdraw() {
        const n = document.getElementById('out-nick').value, s = document.getElementById('out-srv').value, a = parseInt(document.getElementById('out-sum').value);
        if(n && a >= 50 && this.u.bc >= a) {
            this.u.bc -= a; this.save();
            db.ref('payouts/' + userId).push({ nick: n, srv: s, sum: a, status: "‚è≥", date: new Date().toLocaleDateString() });
            alert("–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
        } else alert("–û—à–∏–±–∫–∞: –º–∏–Ω–∏–º—É–º 50 BC");
    },

    loadHistory() {
        db.ref('payouts/' + userId).on('value', (s) => {
            const h = document.getElementById('out-history');
            h.innerHTML = '';
            s.forEach(child => {
                const d = child.val();
                h.innerHTML += `<div class="card flex justify-between items-center py-3 text-[10px]">
                    <div><p class="font-bold">${d.sum} BC</p><p class="text-gray-500">${d.srv}</p></div>
                    <div class="text-right"><p class="text-blue-500 font-black">${d.status}</p><p class="text-[8px] text-gray-700">${d.date}</p></div>
                </div>`;
            });
        });
    },

    tickDaily() {
        const left = (this.u.lastDaily + 86400000) - Date.now();
        const b = document.getElementById('daily-btn');
        if(left > 0) {
            const h = Math.floor(left/3600000), m = Math.floor((left%3600000)/60000), s = Math.floor((left%60000)/1000);
            document.getElementById('timer').innerText = `${h}:${m}:${s}`;
            b.classList.add('opacity-50'); b.disabled = true;
        } else {
            document.getElementById('timer').innerText = "–ì–æ—Ç–æ–≤–æ";
            b.classList.remove('opacity-50'); b.disabled = false;
        }
    },

    openDaily() {
        this.u.lastDaily = Date.now();
        const win = Math.floor(Math.random() * 5000) + 1000;
        this.u.m += win; alert(`–ë–æ–Ω—É—Å: +${win} ‚ÇΩ!`); this.save();
    },

    copyRef() {
        const el = document.getElementById('ref-link');
        el.select(); document.execCommand('copy'); alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
    }
};

window.onload = () => Game.init();
</script>
</body>
</html>
