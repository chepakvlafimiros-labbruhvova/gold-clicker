<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Locus Gold: Syndicate</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --neon: #00f2ff;
            --danger: #ff3b30;
            --warning: #ffcc00;
            --bg: #0a0a0c;
            --card: #16161a;
            --border: #2c2c34;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: #fff; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* HUD */
        .hud { padding: 15px 20px; background: var(--card); border-bottom: 1px solid var(--border); display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-group { display: flex; flex-direction: column; gap: 5px; }
        .stat-info { display: flex; justify-content: space-between; font-size: 10px; text-transform: uppercase; font-weight: bold; color: #8e8e93; }
        .stat-info span.val { color: #fff; }

        .bar { width: 100%; height: 6px; background: #000; border-radius: 3px; overflow: hidden; }
        .bar-f { height: 100%; transition: width 0.3s; }
        .hp-f { background: var(--danger); }
        .en-f { background: var(--neon); }
        .hg-f { background: var(--warning); }

        .cash-display { grid-column: span 2; text-align: center; padding-top: 10px; border-top: 1px solid #222; font-size: 28px; font-weight: 900; color: var(--neon); }

        /* MAIN AREA */
        .viewport { flex: 1; overflow-y: auto; padding: 20px; }
        .screen { display: none; }
        .screen.active { display: block; }

        .card { background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 15px; border: 1px solid var(--border); position: relative; }
        .card h3 { font-size: 18px; margin-bottom: 8px; }
        .card p { font-size: 13px; color: #8e8e93; margin-bottom: 15px; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { background: #1c1c22; border: 1px solid var(--border); padding: 15px 10px; border-radius: 14px; color: #fff; text-align: center; cursor: pointer; display: flex; flex-direction: column; gap: 4px; }
        .btn:active { transform: scale(0.96); background: #25252d; }
        .btn b { font-size: 14px; }
        .btn span { font-size: 9px; color: var(--neon); font-weight: bold; }
        .btn.disabled { opacity: 0.4; pointer-events: none; }

        /* NOTIFICATIONS */
        #toast-container { position: fixed; top: 100px; left: 50%; transform: translateX(-50%); z-index: 1000; pointer-events: none; width: 80%; }
        .toast { background: rgba(0, 242, 255, 0.1); border: 1px solid var(--neon); color: #fff; padding: 10px 15px; border-radius: 10px; font-size: 12px; text-align: center; margin-bottom: 5px; animation: fIn 0.3s ease, fOut 0.3s ease 2s forwards; backdrop-filter: blur(5px); }

        @keyframes fIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fOut { to { opacity: 0; transform: translateY(-10px); } }

        /* NAV */
        .nav { background: var(--card); border-top: 1px solid var(--border); display: flex; padding-bottom: env(safe-area-inset-bottom); }
        .nav-item { flex: 1; padding: 12px 5px; text-align: center; color: #8e8e93; font-size: 9px; text-transform: uppercase; font-weight: 800; }
        .nav-item.active { color: var(--neon); }
        .nav-item i { font-size: 18px; margin-bottom: 4px; display: block; }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div class="hud">
        <div class="stat-group">
            <div class="stat-info">Здоровье <span class="val" id="hp-txt">100</span></div>
            <div class="bar"><div id="hp-bar" class="bar-f hp-f" style="width: 100%"></div></div>
        </div>
        <div class="stat-group">
            <div class="stat-info">Голод <span class="val" id="hg-txt">100</span></div>
            <div class="bar"><div id="hg-bar" class="bar-f hg-f" style="width: 100%"></div></div>
        </div>
        <div class="stat-group" style="grid-column: span 2;">
            <div class="stat-info">Энергия <span class="val" id="en-txt">100</span></div>
            <div class="bar"><div id="en-bar" class="bar-f en-f" style="width: 100%"></div></div>
        </div>
        <div class="cash-display" id="cash-txt">$0</div>
    </div>

    <div class="viewport">
        <div id="scr-street" class="screen active">
            <div class="card">
                <h3>Трущобы Готэма</h3>
                <p>Выживание здесь стоит дорого. Мусор — ваш единственный доход.</p>
                <div class="btn-grid">
                    <div class="btn" onclick="Game.action('scavenge')">
                        <b>Мусорный бак</b>
                        <span>-8 EN | +$1-4</span>
                    </div>
                    <div class="btn" onclick="Game.action('beg')">
                        <b>Просить мелочь</b>
                        <span>-12 EN | +$0-10</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Магазин "24/7"</h3>
                <div class="btn-grid">
                    <div class="btn" onclick="Game.action('buy_bread')">
                        <b>Хлеб ($5)</b>
                        <span>+20 Голод</span>
                    </div>
                    <div class="btn" onclick="Game.action('buy_meds')">
                        <b>Бинты ($20)</b>
                        <span>+30 Здоровье</span>
                    </div>
                </div>
            </div>

            <div class="card" style="border-color: var(--warning);">
                <h3>Ночлег в подворотне</h3>
                <p>Бесплатно, но грязно. Риск простудиться.</p>
                <div class="btn" style="width: 100%; border-color: var(--warning);" onclick="Game.action('sleep')">
                    <b>Уснуть на картоне</b>
                    <span>+60 EN | -15 HG | -5 HP</span>
                </div>
            </div>
        </div>

        <div id="scr-work" class="screen">
            <h2 style="text-align:center; padding: 20px;">Работы закрыты</h2>
            <p style="text-align:center; color:#555;">Купите чистую одежду, чтобы начать работать.</p>
        </div>
    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="UI.nav('street', this)"><i class="fas fa-street-view"></i>Улица</div>
        <div class="nav-item" onclick="UI.nav('work', this)"><i class="fas fa-briefcase"></i>Работа</div>
        <div class="nav-item" onclick="Game.showAd()"><i class="fas fa-play-circle" style="color:var(--warning)"></i>Бонус</div>
    </nav>

    <script>
        const Game = {
            state: { cash: 0, hp: 100, energy: 100, hunger: 100 },

            init() {
                const save = localStorage.getItem('syndicate_v2');
                if(save) this.state = JSON.parse(save);
                this.updateUI();
                setInterval(() => this.tick(), 10000); // Каждые 10 сек пассивный голод
            },

            tick() {
                this.state.hunger = Math.max(0, this.state.hunger - 1);
                if(this.state.hunger <= 0) {
                    this.state.hp = Math.max(0, this.state.hp - 2);
                    this.toast("Вы умираете от голода!", true);
                }
                this.updateUI();
            },

            action(type) {
                switch(type) {
                    case 'scavenge':
                        if(this.state.energy < 8) return this.toast("Нет сил...");
                        this.state.energy -= 8;
                        let found = Math.floor(Math.random() * 4) + 1;
                        if(Math.random() > 0.8) {
                            this.state.hp -= 10;
                            this.toast("Порезались об стекло! -10 HP", true);
                        }
                        this.state.cash += found;
                        this.toast(`Найдено: $${found}`);
                        break;

                    case 'sleep':
                        this.state.energy = Math.min(100, this.state.energy + 60);
                        this.state.hunger = Math.max(0, this.state.hunger - 15);
                        this.state.hp = Math.max(0, this.state.hp - 5);
                        this.toast("Вы поспали, но проголодались и замерзли.");
                        break;

                    case 'buy_bread':
                        if(this.state.cash < 5) return this.toast("Нет денег!");
                        this.state.cash -= 5;
                        this.state.hunger = Math.min(100, this.state.hunger + 20);
                        this.toast("Хлеб съеден.");
                        break;

                    case 'buy_meds':
                        if(this.state.cash < 20) return this.toast("Нет денег!");
                        this.state.cash -= 20;
                        this.state.hp = Math.min(100, this.state.hp + 30);
                        this.toast("Раны обработаны.");
                        break;
                }
                this.save();
                this.updateUI();
            },

            updateUI() {
                document.getElementById('cash-txt').innerText = `$${this.state.cash}`;
                document.getElementById('hp-bar').style.width = this.state.hp + '%';
                document.getElementById('en-bar').style.width = this.state.energy + '%';
                document.getElementById('hg-bar').style.width = this.state.hunger + '%';
                document.getElementById('hp-txt').innerText = this.state.hp;
                document.getElementById('en-txt').innerText = Math.floor(this.state.energy);
                document.getElementById('hg-txt').innerText = this.state.hunger;

                if(this.state.hp <= 0) {
                    alert("Вы погибли в трущобах...");
                    this.state = { cash: 0, hp: 100, energy: 100, hunger: 100 };
                    this.save();
                    location.reload();
                }
            },

            toast(msg, critical = false) {
                const c = document.getElementById('toast-container');
                const t = document.createElement('div');
                t.className = 'toast';
                if(critical) t.style.borderColor = 'var(--danger)';
                t.innerText = msg;
                c.appendChild(t);
                setTimeout(() => t.remove(), 2300);
            },

            save() { localStorage.setItem('syndicate_v2', JSON.stringify(this.state)); },

            showAd() {
                if(typeof Adsgram === 'undefined') return this.toast("Реклама недоступна");
                const ad = Adsgram.init({ blockId: "19895" });
                ad.show().then(() => {
                    this.state.cash += 50;
                    this.updateUI();
                    this.toast("Спонсор прислал вам $50!");
                });
            }
        };

        const UI = {
            nav(id, el) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                document.getElementById('scr-' + id).classList.add('active');
                el.classList.add('active');
            }
        };

        window.onload = () => Game.init();
    </script>
</body>
</html>
