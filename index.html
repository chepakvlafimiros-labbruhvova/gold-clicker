<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Black Russia - Locus Gold Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://adsgram.ai/sdk-v1.js"></script>

    <style>
        :root { --br-red: #ff3333; --br-blue: #0088ff; --bg-dark: #0a0a0c; --card-bg: #141416; }
        body { 
            background: var(--bg-dark); color: #fff; font-family: 'Montserrat', sans-serif; 
            overflow: hidden; height: 100vh; user-select: none; -webkit-tap-highlight-color: transparent;
        }
        .oswald { font-family: 'Oswald', sans-serif; text-transform: uppercase; font-style: italic; }
        
        /* –°—Ç–∏–ª–∏ –∫–ª–∏–∫–µ—Ä–∞ */
        .main-btn-container { position: relative; width: 260px; height: 260px; margin: 20px auto; }
        .main-btn {
            width: 100%; height: 100%; border-radius: 50%;
            background: radial-gradient(circle, #252529 0%, #000 100%);
            border: 8px solid #1f1f22; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
            transition: transform 0.05s ease-out; position: relative; z-index: 2;
        }
        .main-btn:active { transform: scale(0.92); }
        .main-btn::after {
            content: "BR"; font-family: 'Oswald'; font-size: 90px; 
            color: var(--br-red); font-weight: 900; filter: drop-shadow(0 0 10px rgba(255,51,51,0.3));
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–µ–Ω–µ–≥ –ø—Ä–∏ –∫–ª–∏–∫–µ */
        .click-anim {
            position: absolute; color: #4ade80; font-weight: 900; font-family: 'Oswald';
            pointer-events: none; animation: floatUp 0.8s ease-out forwards; z-index: 100;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) opacity(1); }
            100% { transform: translateY(-100px) opacity(0); }
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–µ–π—Å–∞ */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .roulette-container {
            width: 100%; height: 160px; position: relative; overflow: hidden;
            background: #000; border-top: 1px solid #333; border-bottom: 1px solid #333;
        }
        .pointer {
            position: absolute; left: 50%; top: 0; bottom: 0; width: 4px;
            background: var(--br-red); z-index: 10; transform: translateX(-50%);
            box-shadow: 0 0 20px var(--br-red);
        }
        .track { display: flex; position: absolute; height: 100%; transition: transform 9s cubic-bezier(0.1, 0, 0, 1); }
        .track-item {
            min-width: 160px; height: 100%; border-right: 1px solid #1a1a1a;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: linear-gradient(180deg, #141416 0%, #0a0a0c 100%);
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-item { transition: all 0.3s ease; opacity: 0.5; }
        .nav-active { opacity: 1; color: var(--br-red); }
        .nav-active .dot { background: var(--br-red); box-shadow: 0 0 10px var(--br-red); }

        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
    </style>
</head>
<body>

<div class="max-w-md mx-auto h-screen flex flex-col relative border-x border-white/5">
    <header class="p-6 flex justify-between items-center bg-black/40 backdrop-blur-md">
        <div>
            <p class="text-[9px] text-gray-500 font-black uppercase tracking-widest">–ò–≥—Ä–æ–≤–æ–π –±–∞–ª–∞–Ω—Å</p>
            <p id="stat-money" class="text-2xl font-black oswald text-white">0 ‚ÇΩ</p>
        </div>
        <div class="text-right">
            <p class="text-[9px] text-blue-500 font-black uppercase tracking-widest">–î–æ–Ω–∞—Ç —Å—á—ë—Ç</p>
            <p id="stat-bc" class="text-2xl font-black oswald text-blue-400">0 BC</p>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto px-4 pb-32">
        <section id="tab-home" class="tab-view py-6">
            <div class="bg-blue-600/10 border border-blue-500/20 rounded-2xl p-4 mb-6 flex justify-between items-center">
                <div>
                    <p class="text-[10px] font-bold text-blue-400 uppercase">–ú–Ω–æ–∂–∏—Ç–µ–ª—å –¥–æ—Ö–æ–¥–∞</p>
                    <p id="stat-mult" class="text-lg font-black oswald">x1.0</p>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-gray-500 uppercase">–ê–≤—Ç–æ-–∫–ª–∏–∫</p>
                    <p id="stat-auto" class="text-lg font-black oswald">0 ‚ÇΩ/—Å–µ–∫</p>
                </div>
            </div>

            <div class="main-btn-container" onclick="Game.click(event)">
                <div class="main-btn"></div>
            </div>
            
            <p class="text-center text-gray-500 text-[10px] uppercase font-bold tracking-widest mt-4">–ù–∞–∂–∏–º–∞–π –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞</p>
        </section>

        <section id="tab-cases" class="tab-view hidden py-6 space-y-4">
            <h2 class="oswald text-xl italic mb-2 tracking-tighter">–ú–∞–≥–∞–∑–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤</h2>
            
            <div class="bg-gradient-to-r from-blue-900/40 to-black border border-blue-500/30 p-5 rounded-3xl flex justify-between items-center">
                <div class="flex gap-4 items-center">
                    <div class="w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center text-2xl shadow-lg shadow-blue-500/20">üíé</div>
                    <div>
                        <p class="font-black text-xs uppercase">–ö–µ–π—Å "–ú–ê–ñ–û–†"</p>
                        <p id="ad-progress" class="text-[9px] text-blue-400 font-bold uppercase">–î–æ—Å—Ç—É–ø–Ω–æ –∑–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä: 0 / 3</p>
                    </div>
                </div>
                <button id="ad-watch-btn" onclick="Game.watchAd()" class="bg-blue-600 hover:bg-blue-500 px-5 py-2.5 rounded-xl text-[10px] font-black transition-all">–°–ú–û–¢–†–ï–¢–¨</button>
            </div>

            <div class="grid grid-cols-1 gap-4" id="cases-list">
                </div>
        </section>

        <section id="tab-garage" class="tab-view hidden py-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="oswald text-xl italic tracking-tighter">–í–∞—à –≥–∞—Ä–∞–∂</h2>
                <p id="garage-count" class="text-[10px] font-bold text-gray-500 uppercase">–ê–≤—Ç–æ: 0</p>
            </div>
            <div id="garage-grid" class="grid grid-cols-2 gap-3">
                </div>
        </section>
    </main>

    <div id="modal-roulette" class="modal-overlay">
        <h2 class="oswald text-2xl text-gray-400 mb-10 tracking-widest animate-pulse">–ò–°–ü–´–¢–ê–ô –£–î–ê–ß–£</h2>
        <div class="roulette-container">
            <div class="pointer"></div>
            <div id="roulette-track" class="track"></div>
        </div>
        <div id="win-display" class="hidden flex flex-col items-center mt-12 animate-bounceIn">
            <p class="text-gray-500 text-[10px] font-bold uppercase mb-2">–í—ã –ø–æ–ª—É—á–∏–ª–∏:</p>
            <h3 id="win-item-name" class="oswald text-3xl text-center px-10 mb-8 italic">---</h3>
            <button onclick="Game.closeWin()" class="bg-white text-black px-12 py-4 rounded-full font-black text-[11px] uppercase tracking-widest hover:scale-105 transition-transform">–ó–∞–±—Ä–∞—Ç—å –ø—Ä–∏–∑</button>
        </div>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-black/95 border-t border-white/5 flex justify-around py-4 z-50 backdrop-blur-xl">
        <div onclick="Game.switchTab('home')" id="nav-home" class="nav-item flex flex-col items-center gap-1 cursor-pointer nav-active">
            <span class="text-xl">‚ö°</span><span class="text-[8px] font-black uppercase">–†–∞–±–æ—Ç–∞</span>
            <div class="dot w-1 h-1 rounded-full"></div>
        </div>
        <div onclick="Game.switchTab('cases')" id="nav-cases" class="nav-item flex flex-col items-center gap-1 cursor-pointer">
            <span class="text-xl">üì¶</span><span class="text-[8px] font-black uppercase">–ö–µ–π—Å—ã</span>
            <div class="dot w-1 h-1 rounded-full"></div>
        </div>
        <div onclick="Game.switchTab('garage')" id="nav-garage" class="nav-item flex flex-col items-center gap-1 cursor-pointer">
            <span class="text-xl">üèéÔ∏è</span><span class="text-[8px] font-black uppercase">–ì–∞—Ä–∞–∂</span>
            <div class="dot w-1 h-1 rounded-full"></div>
        </div>
    </nav>
</div>

<script>
// –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
const CARS_DATABASE = [
    { id: 1, name: "ZAZ 968", price: 25000, img: "üöó", rarity: "common", sell: 15000 },
    { id: 2, name: "VAZ 2107", price: 180000, img: "üèéÔ∏è", rarity: "common", sell: 120000 },
    { id: 3, name: "BMW M5 E60", price: 2500000, img: "üöô", rarity: "rare", sell: 1800000 },
    { id: 4, name: "Mercedes G63", price: 25000000, img: "üöê", rarity: "epic", sell: 18000000 },
    { id: 5, name: "Bugatti Chiron", price: 150000000, img: "üèéÔ∏è", rarity: "legendary", sell: 110000000 },
    { id: 6, name: "Rolls-Royce Cullinan", price: 85000000, img: "üöî", rarity: "legendary", sell: 60000000 },
    { id: 7, name: "Lada Vesta Sport", price: 1200000, img: "üöó", rarity: "rare", sell: 800000 }
];

const CASE_TYPES = {
    bronze: { name: "–ë—Ä–æ–Ω–∑–æ–≤—ã–π", price: 50000, items: [1, 2, 7], color: "orange" },
    gold: { name: "–ó–æ–ª–æ—Ç–æ–π", price: 1500000, items: [3, 4, 7], color: "yellow" },
    elite: { name: "–≠–ª–∏—Ç–Ω—ã–π", price: 50000000, items: [5, 6, 4], color: "red" }
};

const Game = {
    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
    data: {
        money: 0,
        bc: 0,
        adsCount: 0,
        inventory: [],
        multiplier: 1,
        autoIncome: 0,
        lastSave: Date.now()
    },

    adController: null, // –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä Adsgram —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

    init() {
        // –ó–∞–≥—Ä—É–∑–∫–∞
        const saved = localStorage.getItem('br_locus_v1');
        if (saved) this.data = JSON.parse(saved);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Adsgram —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
        if (window.Adsgram) {
            this.adController = window.Adsgram.init({ blockId: "20963" }); // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à ID
        }

        this.renderCases();
        this.updateUI();
        
        // –¢–∞–π–º–µ—Ä—ã
        setInterval(() => this.autoTick(), 1000);
        setInterval(() => this.save(), 5000);
    },

    // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∫–ª–∞–º—ã —Å–æ–≥–ª–∞—Å–Ω–æ https://docs.adsgram.ai/publisher/reward-interstitial-integration
    async watchAd() {
        if (!this.adController) {
            alert("–†–µ–∫–ª–∞–º–Ω—ã–π –º–æ–¥—É–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram.");
            return;
        }

        const btn = document.getElementById('ad-watch-btn');
        btn.disabled = true;
        btn.innerText = "–ó–ê–ì–†–£–ó–ö–ê...";

        try {
            // –í—ã–∑–æ–≤ –ø–æ–∫–∞–∑–∞ —Ä–µ–∫–ª–∞–º—ã
            const result = await this.adController.show();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            if (result.done) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ—Å–º–æ—Ç—Ä–µ–ª –¥–æ –∫–æ–Ω—Ü–∞
                this.data.adsCount++;
                if (this.data.adsCount >= 3) {
                    this.data.adsCount = 0;
                    this.openCase('elite', true); // –î–∞—Ä–∏–º —ç–ª–∏—Ç–Ω—ã–π –∫–µ–π—Å –∑–∞ —Ä–µ–∫–ª–∞–º—É
                }
                this.updateUI();
                this.save();
            } else {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–ª —Ä–µ–∫–ª–∞–º—É —Ä–∞–Ω—å—à–µ
                alert("–ù—É–∂–Ω–æ –¥–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –¥–æ –∫–æ–Ω—Ü–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥—ã!");
            }
        } catch (e) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ SDK
            console.error(e);
            if (e.error === 'no_ads') alert("–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å–µ–π—á–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã.");
            else alert("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ä–µ–∫–ª–∞–º—ã.");
        } finally {
            btn.disabled = false;
            btn.innerText = "–°–ú–û–¢–†–ï–¢–¨";
        }
    },

    click(e) {
        const gain = 250 * this.data.multiplier;
        this.data.money += gain;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è
        const anim = document.createElement('div');
        anim.className = 'click-anim';
        anim.innerText = `+${gain.toLocaleString()} ‚ÇΩ`;
        anim.style.left = `${e.clientX - 20}px`;
        anim.style.top = `${e.clientY - 20}px`;
        document.body.appendChild(anim);
        setTimeout(() => anim.remove(), 800);

        this.updateUI();
    },

    autoTick() {
        this.data.money += this.data.autoIncome;
        this.updateUI();
    },

    updateUI() {
        document.getElementById('stat-money').innerText = this.data.money.toLocaleString() + ' ‚ÇΩ';
        document.getElementById('stat-bc').innerText = this.data.bc.toLocaleString() + ' BC';
        document.getElementById('ad-progress').innerText = `–î–æ—Å—Ç—É–ø–Ω–æ –∑–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä: ${this.data.adsCount} / 3`;
        document.getElementById('stat-mult').innerText = `x${this.data.multiplier.toFixed(1)}`;
        document.getElementById('stat-auto').innerText = `${this.data.autoIncome.toLocaleString()} ‚ÇΩ/—Å–µ–∫`;
        
        this.renderGarage();
    },

    renderCases() {
        const container = document.getElementById('cases-list');
        container.innerHTML = '';
        
        Object.entries(CASE_TYPES).forEach(([id, cfg]) => {
            container.innerHTML += `
                <div class="bg-white/5 border border-white/5 p-4 rounded-2xl flex justify-between items-center">
                    <div class="flex gap-3 items-center">
                        <div class="text-2xl">üì¶</div>
                        <div>
                            <p class="font-bold text-xs uppercase">${cfg.name} –ö–û–ù–¢–ï–ô–ù–ï–†</p>
                            <p class="text-[9px] text-gray-500 font-bold">${cfg.price.toLocaleString()} ‚ÇΩ</p>
                        </div>
                    </div>
                    <button onclick="Game.openCase('${id}')" class="bg-white/10 hover:bg-white/20 px-6 py-2 rounded-xl text-[10px] font-black tracking-widest transition-all">–ö–£–ü–ò–¢–¨</button>
                </div>
            `;
        });
    },

    renderGarage() {
        const grid = document.getElementById('garage-grid');
        grid.innerHTML = '';
        document.getElementById('garage-count').innerText = `–ê–≤—Ç–æ: ${this.data.inventory.length}`;

        if (this.data.inventory.length === 0) {
            grid.innerHTML = '<p class="col-span-2 text-center text-gray-700 py-10 text-[10px] uppercase font-bold">–ì–∞—Ä–∞–∂ –ø—É—Å—Ç</p>';
            return;
        }

        this.data.inventory.forEach((item, index) => {
            grid.innerHTML += `
                <div class="bg-white/5 p-4 rounded-3xl border border-white/5 text-center relative overflow-hidden group">
                    <span class="text-4xl block mb-2">${item.img}</span>
                    <p class="text-[9px] font-black uppercase text-gray-300 truncate">${item.name}</p>
                    <button onclick="Game.sellCar(${index})" class="mt-3 w-full py-2 bg-red-600/10 text-red-500 text-[8px] font-black rounded-lg uppercase tracking-tighter opacity-0 group-hover:opacity-100 transition-opacity">–ü—Ä–æ–¥–∞—Ç—å: ${item.sell.toLocaleString()} ‚ÇΩ</button>
                </div>
            `;
        });
    },

    openCase(type, isFree = false) {
        const cfg = CASE_TYPES[type];
        if (!isFree && this.data.money < cfg.price) {
            alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");
            return;
        }

        if (!isFree) this.data.money -= cfg.price;
        this.updateUI();

        // –õ–æ–≥–∏–∫–∞ —Ä—É–ª–µ—Ç–∫–∏
        const track = document.getElementById('roulette-track');
        const modal = document.getElementById('modal-roulette');
        track.style.transition = 'none';
        track.style.transform = 'translateX(0)';
        track.innerHTML = '';

        let items = [];
        for (let i = 0; i < 60; i++) {
            const randomId = cfg.items[Math.floor(Math.random() * cfg.items.length)];
            const car = CARS_DATABASE.find(c => c.id === randomId);
            items.push(car);
            track.innerHTML += `
                <div class="track-item">
                    <span class="text-4xl mb-2">${car.img}</span>
                    <p class="text-[8px] font-bold text-gray-500 uppercase">${car.name}</p>
                </div>
            `;
        }

        const winCar = items[52];
        this.lastWin = winCar;

        modal.style.display = 'flex';
        
        setTimeout(() => {
            track.style.transition = 'transform 9s cubic-bezier(0.1, 0, 0, 1)';
            const shift = (52 * 160) - (window.innerWidth / 2) + 80;
            track.style.transform = `translateX(-${shift}px)`;
        }, 50);

        setTimeout(() => {
            document.getElementById('win-display').classList.remove('hidden');
            document.getElementById('win-item-name').innerText = winCar.name;
        }, 9500);
    },

    closeWin() {
        this.data.inventory.push(this.lastWin);
        this.data.multiplier += 0.2; // –ë–æ–Ω—É—Å –∫ –∫–ª–∏–∫—É –∑–∞ –º–∞—à–∏–Ω—É
        this.data.autoIncome += (this.lastWin.price * 0.001); // –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥
        
        document.getElementById('modal-roulette').style.display = 'none';
        document.getElementById('win-display').classList.add('hidden');
        this.updateUI();
        this.save();
    },

    sellCar(index) {
        const car = this.data.inventory[index];
        this.data.money += car.sell;
        this.data.multiplier -= 0.2;
        this.data.autoIncome -= (car.price * 0.001);
        this.data.inventory.splice(index, 1);
        this.updateUI();
        this.save();
    },

    switchTab(id) {
        document.querySelectorAll('.tab-view').forEach(t => t.classList.add('hidden'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-active'));
        
        document.getElementById('tab-' + id).classList.remove('hidden');
        document.getElementById('nav-' + id).classList.add('nav-active');
    },

    save() {
        localStorage.setItem('br_locus_v1', JSON.stringify(this.data));
    }
};

// –ó–∞–ø—É—Å–∫
window.onload = () => Game.init();
</script>
</body>
</html>
